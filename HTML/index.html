<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Management System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        .container {
            max-width: 400px;
            background: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
        }
        input, button, select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        button {
            background-color: #007BFF;
            color: white;
            cursor: pointer;
            border: none;
        }
        button:hover {
            background-color: #0056b3;
        }
        .hidden {
            display: none;
        }
        table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>

<div class="container" id="loginContainer">
    <h1>Login</h1>
    <input type="text" id="username" placeholder="Username" required>
    <input type="password" id="password" placeholder="Password" required>
    <button onclick="login()">Login</button>
</div>

<div class="container hidden" id="attendanceContainer">
    <h1>Attendance Management System</h1>
    <button onclick="showRegistration()">Student Registration</button>
    <button onclick="markAttendance()">Mark Attendance</button>
    <button onclick="showMonthlyReport()">Monthly Attendance Report</button>
    <button onclick="showDailyReport()">Daily Attendance Report</button>
    <button onclick="backupData()">Backup Data</button>
    <div id="content" style="margin-top: 20px;"></div>
</div>

<script>
    const students = JSON.parse(localStorage.getItem('students')) || [];
    const attendance = JSON.parse(localStorage.getItem('attendance')) || {};

    function login() {
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        
        if (username === 'admin' && password === 'ayaz123') {
            document.getElementById('loginContainer').classList.add('hidden');
            document.getElementById('attendanceContainer').classList.remove('hidden');
        } else {
            alert('Invalid credentials! Please try again.');
        }
    }

    function showRegistration() {
        document.getElementById('content').innerHTML = `
            <h2>Student Registration</h2>
            <form onsubmit="registerStudent(event)">
                <input type="text" id="firstName" placeholder="First Name" required>
                <input type="text" id="lastName" placeholder="Last Name" required>
                <input type="text" id="mobileNumber" placeholder="Mobile Number" required>
                <button type="submit">Register</button>
            </form>
        `;
    }

    function registerStudent(event) {
        event.preventDefault();
        const firstName = document.getElementById('firstName').value;
        const lastName = document.getElementById('lastName').value;
        const mobileNumber = document.getElementById('mobileNumber').value;

        if (students.some(student => student.mobileNumber === mobileNumber)) {
            alert('Student with this mobile number already exists!');
            return;
        }

        const student = { firstName, lastName, mobileNumber };
        students.push(student);
        attendance[mobileNumber] = { inTime: null, outTime: null, date: null };

        localStorage.setItem('students', JSON.stringify(students));
        localStorage.setItem('attendance', JSON.stringify(attendance));
        
        alert('Student registered successfully!');
        document.getElementById('firstName').value = '';
        document.getElementById('lastName').value = '';
        document.getElementById('mobileNumber').value = '';
    }

    function markAttendance() {
        let options = students.map(student => 
            `<option value="${student.mobileNumber}">${student.firstName} ${student.lastName}</option>`
        ).join('');

        document.getElementById('content').innerHTML = `
            <h2>Mark Attendance</h2>
            <form>
                <label for="studentSelect">Select Student:</label>
                <select id="studentSelect">
                    ${options}
                </select>
                <button type="button" onclick="markIn()">Mark In</button>
                <button type="button" onclick="markOut()">Mark Out</button>
            </form>
        `;
    }

    function markIn() {
        const selectedMobile = document.getElementById('studentSelect').value;
        if (selectedMobile) {
            const now = new Date();
            attendance[selectedMobile].inTime = now.toLocaleTimeString();
            attendance[selectedMobile].date = now.toLocaleDateString(); // Store the date
            alert(`Student marked as Present at ${attendance[selectedMobile].inTime}.`);
            localStorage.setItem('attendance', JSON.stringify(attendance));
        } else {
            alert('Please select a student to mark attendance.');
        }
    }

    function markOut() {
        const selectedMobile = document.getElementById('studentSelect').value;
        if (selectedMobile) {
            const now = new Date();
            attendance[selectedMobile].outTime = now.toLocaleTimeString();
            alert(`Student marked as Absent at ${attendance[selectedMobile].outTime}.`);
            localStorage.setItem('attendance', JSON.stringify(attendance));
        } else {
            alert('Please select a student to mark attendance.');
        }
    }

    function showDailyReport() {
        const today = new Date().toLocaleDateString();
        let reportRows = students.map(student => {
            const record = attendance[student.mobileNumber];
            return `
                <tr>
                    <td>${student.firstName} ${student.lastName}</td>
                    <td>${record.date === today ? record.inTime : 'Not marked'}</td>
                    <td>${record.date === today ? record.outTime : 'Not marked'}</td>
                    <td>${record.date || 'Not marked'}</td>
                </tr>
            `;
        }).join('');

        const reportTable = `
            <h2>Daily Attendance Report</h2>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>In Time</th>
                        <th>Out Time</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody>
                    ${reportRows || '<tr><td colspan="4">No attendance marked today.</td></tr>'}
                </tbody>
            </table>
        `;

        document.getElementById('content').innerHTML = reportTable;
    }

    function showMonthlyReport() {
        document.getElementById('content').innerHTML = `
            <h2>Monthly Attendance Report</h2>
            <form onsubmit="generateMonthlyReport(event)">
                <label for="startDate">Start Date:</label>
                <input type="date" id="startDate" required>
                <label for="endDate">End Date:</label>
                <input type="date" id="endDate" required>
                <button type="submit">Generate Report</button>
            </form>
        `;
    }

    function generateMonthlyReport(event) {
        event.preventDefault();
        const startDate = new Date(document.getElementById('startDate').value);
        const endDate = new Date(document.getElementById('endDate').value);
        let reportRows = students.map(student => {
            const record = attendance[student.mobileNumber];
            const recordDate = new Date(record.date);
            if (record.date && recordDate >= startDate && recordDate <= endDate) {
                return `
                    <tr>
                        <td>${student.firstName} ${student.lastName}</td>
                        <td>${record.inTime || 'Not marked'}</td>
                        <td>${record.outTime || 'Not marked'}</td>
                        <td>${record.date}</td>
                    </tr>
                `;
            }
            return '';
        }).filter(row => row).join('');

        const reportTable = `
            <h2>Monthly Attendance Report</h2>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>In Time</th>
                        <th>Out Time</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody>
                    ${reportRows || '<tr><td colspan="4">No attendance marked in this date range.</td></tr>'
